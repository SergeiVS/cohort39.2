# Lesson 29

В языке программирования Java, `Optional` является контейнером, который может содержать или не содержать значение. Этот класс был введен в Java 8 как часть пакета `java.util` и предназначен для обеспечения более чистого и менее подверженного ошибкам способа работы с значениями, которые могут быть `null`.

Основная идея использования `Optional` заключается в том, чтобы предоставить типобезопасный альтернативный способ представления опциональных значений, вместо использования `null`. Это помогает избежать `NullPointerException`, которая является одной из наиболее частых ошибок в Java.

Основные методы класса `Optional`:

1. **`empty()`**: Возвращает пустой объект `Optional`.

2. **`of(value)`**: Возвращает `Optional` с не-null значением. Выбрасывает `NullPointerException`, если значение равно `null`.

3. **`ofNullable(value)`**: Возвращает `Optional` с указанным значением, которое может быть `null`.

4. **`isPresent()`**: Возвращает `true`, если в `Optional` есть значение, и `false`, если нет.

5. **`ifPresent(Consumer)`**: Выполняет заданное действие, если значение присутствует в `Optional`.

6. **`orElse(defaultValue)`**: Возвращает значение, если оно присутствует, иначе возвращает указанное значение по умолчанию.

Использование `Optional` помогает явно обозначить, что метод может вернуть `null`, и требует от разработчика обработать эту ситуацию. 
Однако его использование не рекомендуется в качестве параметра метода или в полях классов, так как это может усложнить использование вашего API и увеличить расход памяти.


Давайте рассмотрим, зачем нужен класс `Optional` в Java и как использовать его основные методы на примерах.

### Зачем Нужен `Optional`

`Optional` помогает в обработке ситуаций, когда значение может отсутствовать, и тем самым предотвращает `NullPointerException`. Он предоставляет более ясный и безопасный способ обработки потенциально отсутствующих значений, по сравнению с традиционным подходом, когда `null` используется для обозначения отсутствия значения.

#### Пример Без `Optional`

```java
public String getCompanyName(User user) {
    if (user != null && user.getCompany() != null) {
        return user.getCompany().getName();
    } else {
        return "Неизвестная компания";
    }
}
```

В этом примере, мы должны явно проверить `user` и `user.getCompany()` на `null`, чтобы избежать `NullPointerException`.

Теперь будем использовать `Optional` для явного контроля наличия или отсутствия значения, вместо традиционных проверок на `null`.

```java
public String getCompanyName(User user) {
    // Создаем Optional из user
    Optional<User> optionalUser = Optional.ofNullable(user);

    if (optionalUser.isPresent()) {
        // Получаем компанию, если user не null
        Optional<Company> optionalCompany = Optional.ofNullable(optionalUser.get().getCompany());

        if (optionalCompany.isPresent()) {
            // Возвращаем название компании, если оно не null
            return optionalCompany.get().getName();
        }
    }

    return "Неизвестная компания";
}
```

В этом коде, мы создаем `Optional` объекты для `user` и `user.getCompany()`. Затем мы используем `isPresent()` для проверки, существует ли значение внутри `Optional`, и `get()` для получения этого значения. Это обеспечивает безопасное извлечение значений без риска возникновения `NullPointerException`.

Здесь `Optional` помогает нам избежать явных проверок на `null` и делает код более читаемым.

### Основные Методы `Optional`

1. **`ofNullable`**

   Используется для создания `Optional` объекта, который может содержать `null`.

   ```java
   Optional<String> optionalString = Optional.ofNullable("Привет, мир!");
   ```

2. **`isPresent` **

   `isPresent` проверяет, содержит ли `Optional` значение. 

   ```java
   if (optionalString.isPresent()) {
       System.out.println(optionalString.get());
   }

   ```

3. **`orElse` и `orElseGet`**

   `orElse` возвращает значение, если оно присутствует, иначе возвращает другое значение. `orElseGet` делает то же самое, но значение по умолчанию предоставляется через `Supplier`.

   ```java
   String result = optionalString.orElse("Значение по умолчанию");

   ```

Использование `Optional` делает код более надежным и удобочитаемым, поскольку уменьшает риск появления `NullPointerException` и делает явной обработку отсутствующих значений.

